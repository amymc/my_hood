

  <% if current_user %>
<div class="btn-group">
<button class="btn btn-inverse">Admin</button>
  <button class="btn btn-inverse dropdown-toggle" data-toggle="dropdown"> 
    <%#adds dropdown arrow%>
    <span class="caret"></span>
  </button>
  
  
  <ul class="dropdown-menu">
    <li>
    	<a href="events/new">Add new event</a>
  	</li>
  	<li>
  		<a href="users/new">create new user</a>
  	</li>
  </ul>
</div>
 <% end %>		

	<div class="search">	
	<%# input append ensures that the text box and the submit button are aligned%>
	<div class="input-append">
			<%# Puts the search box in the right hand side of the nav bar%>
			<form class="navbar-search pull-right">
			<%= form_tag events_path, :method => 'get' do %>
  				<%= text_field_tag :search, params[:search] %>
  				 <button type="submit" class="btn btn-info">
   					 search <i class="icon-search"></i> 
   				</button>
			<% end %>
			</form>
 	</div>
 	</div>
 </ul>
 <br/>
  <br/>
   <br/>
   
       <%#= gmaps("markers" => {"data" => @json},   
        "map_options" => {"detect_location" => true, 
            "center_on_user" => true, "zoom" => 4 })%>
       

 
 
 <div class="listing">	
 
<div class="event_item">
 <table class="table table-hover">
  <thead>
  <tr>
    <th>Title</th>
    <th>Description</th>
    <th>Date</th>
    <th>Genre</th>
    <th>Location</th>
  </tr>
  </thead>
<tbody>

<%@events.each do |event| %>

<tr>
	<td><%= image_tag event.image_url.to_s %></td>
    <td><%= link_to event.title, event %></td>
    <td><%= event.description %></td>
    <td><%= event.date %></td>
    <td><%= event.genre %></td>  
    <td><%= event.location %></td>
    

    <% if current_user %>
        <td><%= link_to 'Edit', edit_event_path(event) %></td>
    	<td><%= link_to 'Destroy', event, confirm: 'Are you sure?', method: :delete %></td>
    <% end %>  

  </tr>


<% end %>
  </tbody>
</table>
  </div> 

</div>




    

<h1><%= @events.size %> events found within your search radius</h1>
<ol>
<% @events.each do |event| %>
<li><%= event.title %><br/></li>
<% end %>
</ol>


<br/>
<br/>
<br/>
<br/>
<div id="map"><%# gmaps4rails(@json) %><%#gmaps(:map_options => {:detect_location => true, :center_on_user => true })%>
<%#= gmaps( :map_options => {  :detect_location => true},
           :markers     => { :data => @json } 
         ) %>
         
         <%= gmaps( :map_options => { :disableDefaultUI => true, :auto_adjust => true, :detect_location => true, :center_on_user => true },
         :markers     => { :data => @json}
         #:scripts     => :none  
         ) %>
         </div>
         

  


</body>
 <% content_for :scripts do %>
        <script type="text/javascript">
    Gmaps.map.geolocationSuccess = function(){
          if(Gmaps.map.callback){
            var lng = Gmaps.map.userLocation.lng();
            var lat = Gmaps.map.userLocation.lat();
            Gmaps.map.addMarkers([{
                "lng": lng,
                "lat": lat,
                "picture": "http://gmaps-samples.googlecode.com/svn/trunk/markers/pink/blank.png",
                "width": "37",
                "height": "34"
            }]);
          }

        };

        </script>
        <% end %>
         
<%= javascript_include_tag :all %>
<%= stylesheet_link_tag :all %>

